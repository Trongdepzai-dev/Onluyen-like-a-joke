<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dev Console</title>
  <style>
    * {margin:0; padding:0; box-sizing:border-box;}

    body {
      font-family: 'Fira Code', 'Consolas', monospace;
      background: #121212;
      color: #e0e0e0;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: linear-gradient(90deg,#1f1f1f,#2b2b2b);
      padding: 12px 20px;
      border-bottom: 1px solid #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .title {
      font-size: 15px;
      color: #fff;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .controls {display: flex; gap: 10px;}

    .btn {
      padding: 6px 12px;
      background: #0e639c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    .btn:hover {background: #1177bb; transform: translateY(-1px);}
    .btn.clear {background: #d32f2f;}
    .btn.clear:hover {background: #e53935;}

    .filter-bar {
      background: #1a1a1a;
      padding: 10px 20px;
      border-bottom: 1px solid #333;
      display: flex;
      gap: 10px;
      align-items: center;
      position: sticky;
      top: 48px;
      z-index: 9;
    }

    .filter-label {font-size: 12px; color: #aaa;}
    .filter-btn {
      padding: 5px 12px;
      background: #2b2b2b;
      color: #bbb;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s ease;
    }
    .filter-btn:hover {background:#333; color:white;}
    .filter-btn.active {background: #0e639c; color: white;}

    .console-container {
      flex: 1;
      overflow-y: auto;
      padding: 15px 20px;
      font-size: 13px;
      line-height: 1.6;
    }

    .log-entry {
      margin-bottom: 6px;
      padding: 6px 12px;
      border-radius: 6px;
      word-wrap: break-word;
      display: flex;
      align-items: flex-start;
      gap: 8px;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(4px);}
      to {opacity: 1; transform: translateY(0);}
    }

    .log-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #888;
      min-width: 100px;
    }

    .log-time {
      font-size: 11px;
    }
    
    .log-message {
      flex: 1;
      padding-left: 8px;
      border-left: 1px solid #333;
    }


    .log-entry.info {color:#64b5f6; background:rgba(100,181,246,0.08);}
    .log-entry.success {color:#81c784; background:rgba(129,199,132,0.08);}
    .log-entry.error {color:#e57373; background:rgba(229,115,115,0.08);}
    .log-entry.warning {color:#ffb74d; background:rgba(255,183,77,0.08);}

    .log-icon {font-size: 14px; opacity: 0.8;}

    .stats {
      background: #1a1a1a;
      padding: 10px 20px;
      border-top: 1px solid #333;
      font-size: 12px;
      color: #bbb;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 6px;
      background: #2b2b2b;
      padding: 4px 10px;
      border-radius: 20px;
    }
    .stat-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    .stat-dot.info { background: #64b5f6; }
    .stat-dot.success { background: #81c784; }
    .stat-dot.error { background: #e57373; }
    .stat-dot.warning { background: #ffb74d; }

    ::-webkit-scrollbar {width: 10px;}
    ::-webkit-scrollbar-thumb {background: #444; border-radius: 6px;}
    ::-webkit-scrollbar-thumb:hover {background: #555;}
  </style>
</head>
<body>
  <div class="header">
    <div class="title">üîß Developer Console</div>
    <div class="controls">
      <button class="btn" onclick="toggleAutoScroll()">Auto Scroll: ON</button>
      <button class="btn clear" onclick="clearLogs()">Clear</button>
    </div>
  </div>

  <div class="filter-bar">
    <span class="filter-label">Filters:</span>
    <button class="filter-btn active" data-type="all" onclick="setFilter('all')">All</button>
    <button class="filter-btn" data-type="info" onclick="setFilter('info')">Info</button>
    <button class="filter-btn" data-type="success" onclick="setFilter('success')">Success</button>
    <button class="filter-btn" data-type="error" onclick="setFilter('error')">Error</button>
    <button class="filter-btn" data-type="warning" onclick="setFilter('warning')">Warning</button>
  </div>

  <div class="console-container" id="console"></div>

  <div class="stats">
    <div class="stat-item"><div class="stat-dot info"></div> Info: <span id="info-count">0</span></div>
    <div class="stat-item"><div class="stat-dot success"></div> Success: <span id="success-count">0</span></div>
    <div class="stat-item"><div class="stat-dot error"></div> Error: <span id="error-count">0</span></div>
    <div class="stat-item"><div class="stat-dot warning"></div> Warning: <span id="warning-count">0</span></div>
    <div class="stat-item">Total: <span id="total-count">0</span></div>
    <div class="stat-item">Memory: <span id="memory-usage">...</span></div>
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    let autoScroll = true;
    let currentFilter = 'all';
    let logs = [];
    let stats = {info:0, success:0, error:0, warning:0, total:0};

    ipcRenderer.on('dev-log', (event, data) => {
      addLog(data.message, data.type);
    });

    function addLog(message, type = 'info') {
      const consoleDiv = document.getElementById('console');
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry ${type}`;
      logEntry.dataset.type = type;

      const icon = {
        info:"‚ÑπÔ∏è", success:"‚úÖ", error:"‚ùå", warning:"‚ö†Ô∏è"
      }[type] || "üìå";

      const timestamp = new Date().toLocaleTimeString();
      logEntry.innerHTML = `<span class="log-meta"><span class="log-icon">${icon}</span><span class="log-time">${timestamp}</span></span> <span class="log-message">${message}</span>`;
      logs.push({ message, type, element: logEntry });

      stats[type] = (stats[type]||0)+1;
      stats.total++;
      updateStats();

      if (currentFilter !== 'all' && currentFilter !== type) {
        logEntry.style.display = 'none';
      }

      consoleDiv.appendChild(logEntry);
      if (autoScroll) consoleDiv.scrollTop = consoleDiv.scrollHeight;
    }

    function clearLogs() {
      document.getElementById('console').innerHTML = '';
      logs = [];
      stats = {info:0, success:0, error:0, warning:0, total:0};
      updateStats();
    }

    function toggleAutoScroll() {
      autoScroll = !autoScroll;
      const btn = event.target;
      btn.textContent = `Auto Scroll: ${autoScroll ? 'ON' : 'OFF'}`;
    }

    function setFilter(type) {
      currentFilter = type;
      document.querySelectorAll('.filter-btn').forEach(btn=>{
        btn.classList.toggle('active', btn.dataset.type===type);
      });
      logs.forEach(log=>{
        log.element.style.display = (type==='all'||log.type===type)?'flex':'none';
      });
    }

    function updateStats() {
      document.getElementById('info-count').textContent = stats.info;
      document.getElementById('success-count').textContent = stats.success;
      document.getElementById('error-count').textContent = stats.error;
      document.getElementById('warning-count').textContent = stats.warning;
      document.getElementById('total-count').textContent = stats.total;
    }

    function updateMemoryUsage() {
      if (performance.memory) {
        const used = (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(2);
        const total = (performance.memory.jsHeapSizeLimit / 1024 / 1024).toFixed(2);
        document.getElementById('memory-usage').textContent = `${used} MB / ${total} MB`;
      } else {
        document.getElementById('memory-usage').textContent = 'N/A';
      }
    }

    setInterval(updateMemoryUsage, 2000); // C·∫≠p nh·∫≠t m·ªói 2 gi√¢y

    addLog('üöÄ Dev Console ƒë√£ s·∫µn s√†ng!', 'success');
    addLog('üí° Nh·∫•n F12 ƒë·ªÉ toggle Dev Console', 'info');
  </script>
</body>
</html>